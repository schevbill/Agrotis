CREATE TABLE CLIENTE (
    ID_CLIENTE           BIGINT NOT NULL,
    NOME                 VARCHAR(100) NOT NULL,
    CEP                  CHAR(8) NOT NULL,
    LOGRADOURO           VARCHAR(150) NOT NULL,
    NUMERO               VARCHAR(10) NOT NULL,
    COMPLEMENTO          VARCHAR(50),
    BAIRRO               VARCHAR(150) NOT NULL,
    CIDADE               VARCHAR(150) NOT NULL,
    UF                   CHAR(2) NOT NULL,
    IBGE                 INT
);

ALTER TABLE CLIENTE ADD CONSTRAINT PK_CLIENTE PRIMARY KEY (ID_CLIENTE);

CREATE GENERATOR GEN_CLIENTE_ID;

CREATE OR ALTER TRIGGER CLIENTE_BI FOR CLIENTE
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID_CLIENTE IS NULL) THEN
    NEW.ID_CLIENTE = GEN_ID(GEN_CLIENTE_ID,1);
END ;

------------------------------------------------------

CREATE TABLE PRODUTO (
    ID_PRODUTO           BIGINT NOT NULL,
    DESCRICAO            VARCHAR(100) NOT NULL,
    VALOR_UNITARIO       DOUBLE PRECISION NOT NULL
);

ALTER TABLE PRODUTO ADD CONSTRAINT PK_PRODUTO PRIMARY KEY (ID_PRODUTO);

CREATE GENERATOR GEN_PRODUTO_ID;

CREATE OR ALTER TRIGGER PRODUTO_BI FOR PRODUTO
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID_PRODUTO IS NULL) THEN
    NEW.ID_PRODUTO = GEN_ID(GEN_PRODUTO_ID,1);
END ;

-----------------------------------------------------

CREATE TABLE PEDIDO (
    ID_PEDIDO            BIGINT NOT NULL,
    REFERENCIA           VARCHAR(100) NOT NULL,
    NUM_PEDIDO           BIGINT NOT NULL,
    DATA_EMISSAO         DATE NOT NULL,
    ID_CLIENTE           BIGINT NOT NULL,
    TIPO_OPERACAO        CHAR(1) NOT NULL,
    TOTAL_PEDIDO         DOUBLE PRECISION NOT NULL
);

ALTER TABLE PEDIDO ADD CONSTRAINT PK_PEDIDO PRIMARY KEY (ID_PEDIDO);
ALTER TABLE PEDIDO ADD FOREIGN KEY (ID_CLIENTE) REFERENCES CLIENTE(ID_CLIENTE) ON DELETE CASCADE ON UPDATE CASCADE;

CREATE GENERATOR GEN_PEDIDO_ID;

CREATE OR ALTER TRIGGER PEDIDO_BI FOR PEDIDO
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID_PEDIDO IS NULL) THEN
    NEW.ID_PEDIDO = GEN_ID(GEN_PEDIDO_ID,1);
END ;


CREATE GENERATOR GEN_NUM_PEDIDO_ID;

CREATE OR ALTER TRIGGER NUM_PEDIDO_BI FOR PEDIDO
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.NUM_PEDIDO IS NULL) THEN
    NEW.NUM_PEDIDO = GEN_ID(GEN_NUM_PEDIDO_ID,1);
END ;
------------------------------------------------------

CREATE TABLE PEDIDO_ITEM (
    ID_PEDIDO_ITEM       BIGINT NOT NULL,
    ID_PEDIDO            BIGINT NOT NULL,
    ID_PRODUTO           BIGINT NOT NULL,
    QUANTIDADE           DOUBLE PRECISION NOT NULL,
    VALOR_UNITARIO       DOUBLE PRECISION NOT NULL,
    TOTAL_ITEM           DOUBLE PRECISION NOT NULL
);


ALTER TABLE PEDIDO_ITEM ADD CONSTRAINT PK_PEDIDO_ITEM PRIMARY KEY (ID_PEDIDO_ITEM);
ALTER TABLE PEDIDO_ITEM ADD FOREIGN KEY (ID_PEDIDO) REFERENCES PEDIDO(ID_PEDIDO) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE PEDIDO_ITEM ADD FOREIGN KEY (ID_PRODUTO) REFERENCES PRODUTO(ID_PRODUTO) ON DELETE CASCADE ON UPDATE CASCADE;

CREATE GENERATOR GEN_PEDIDO_ITEM_ID;

CREATE OR ALTER TRIGGER PEDIDO_ITEM_BI FOR PEDIDO_ITEM
ACTIVE BEFORE INSERT POSITION 0
AS
BEGIN
  IF (NEW.ID_PEDIDO_ITEM IS NULL) THEN
    NEW.ID_PEDIDO_ITEM = GEN_ID(GEN_PEDIDO_ITEM_ID,1);
END ;

